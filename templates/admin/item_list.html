<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products List</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <!-- INTERNAL RESPONSIVE CSS -->
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            font-family: Arial, sans-serif;
        }

        /* Sticky Header + Navbar */
        header {
            position: sticky;
            top: 0;
            z-index: 1000;
            background: #1e4fd7;
            color: white;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        header h2 {
            font-size: 20px;
        }

        nav a {
            color: white;
            margin-left: 15px;
            text-decoration: none;
            font-weight: 500;
        }

        nav a:hover {
            text-decoration: underline;
        }

        /* Page Content */
        h2 {
            margin: 20px;
        }

        form {
            margin: 0 20px 15px 20px;
        }

        input, select, button {
            padding: 6px 10px;
            margin-right: 5px;
        }

        a {
            margin-left: 20px;
        }

        /* Table Responsive Wrapper */
        .table-wrapper {
            width: 100%;
            overflow-x: auto;
            padding: 0 20px;
        }

        table {
            width: 100%;
            min-width: 900px;
            border-collapse: collapse;
        }

        th, td {
            text-align: center;
            padding: 10px;
            white-space: nowrap;
        }

        img {
            max-width: 70px;
            height: auto;
        }

        /* Footer Sticky Bottom */
        footer {
            margin-top: auto;
            background: #f1f1f1;
            text-align: center;
            padding: 12px;
            font-size: 14px;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                align-items: flex-start;
            }

            nav {
                margin-top: 8px;
            }

            nav a {
                margin-left: 0;
                margin-right: 10px;
            }
        }
    </style>
</head>

<body>

<header>
    <h2>ðŸ›’ SmartCart</h2>
    <nav>
        <a href="/admin/add-item">Add Product</a>
        <a href="/admin/profile">Admin Profile</a>
        <a href="/admin-logout">Logout</a>
    </nav>
</header>

<h2>Product List</h2>

<!-- Flash Messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% for category, message in messages %}
    <p style="color:green; margin-left:20px;">{{ message }}</p>
  {% endfor %}
{% endwith %}

<!-- Search Form -->
<form method="GET" action="/admin/item-list">
    <input type="text" name="search" placeholder="Search product..."
           value="{{ request.args.get('search', '') }}">
    <button type="submit">Search</button>
</form>

<!-- Category Filter -->
<form method="GET" action="/admin/item-list">
    <select name="category">
        <option value="">All Categories</option>
        {% for cat in categories %}
        <option value="{{ cat.category }}"
            {% if request.args.get('category') == cat.category %} selected {% endif %}>
            {{ cat.category }}
        </option>
        {% endfor %}
    </select>
    <button type="submit">Filter</button>
</form>

<br>

<a href="/admin/add-item">Add New Product</a>
<br><br>

<!-- Responsive Table -->
<div class="table-wrapper">
<table border="1" cellpadding="10">
    <tr>
        <th>ID</th>
        <th>Image</th>
        <th>Name</th>
        <th>Category</th>
        <th>Price</th>
        <th>View</th>
        <th>Edit</th>
        <th>Delete</th>
    </tr>

    {% for product in products %}
    <tr>
        <td>{{ product.product_id }}</td>
        <td>
            <img src="/static/uploads/product_images/{{ product.image }}">
        </td>
        <td>{{ product.name }}</td>
        <td>{{ product.category }}</td>
        <td>â‚¹{{ product.price }}</td>
        <td>
            <a href="/admin/view-item/{{ product.product_id }}">View</a>
        </td>
        <td>
            <a href="/admin/update-item/{{ product.product_id }}">Edit</a>
        </td>
        <td>
            <a href="/admin/delete-item/{{ product.product_id }}"
               onclick="return confirm('Are you sure you want to delete this product?')">
               Delete
            </a>
        </td>
    </tr>
    {% endfor %}
</table>
</div>

<footer>
    &copy; 2026 SmartCart built by Suhitha. All rights reserved.
</footer>

</body>
</html>
